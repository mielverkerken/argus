# 
#  Gargoyle Software. Argus flow data generation.
#  Copyright (c) 2000-2024 QoSient, LLC
#  All rights reserved.
# 
#  THE ACCOMPANYING PROGRAM IS PROPRIETARY SOFTWARE OF QoSIENT, LLC,
#  AND CANNOT BE USED, DISTRIBUTED, COPIED OR MODIFIED WITHOUT
#  EXPRESS PERMISSION OF QoSIENT, LLC.
# 
#  QOSIENT, LLC DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS
#  SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
#  AND FITNESS, IN NO EVENT SHALL QOSIENT, LLC BE LIABLE FOR ANY
#  SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
#  WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER
#  IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,
#  ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
#  THIS SOFTWARE.
# 
# Makefile for Gargoyle
# Copyright (C) 1996-2024 QoSient, LLC
# All rights reserved
#
#### Start of system configuration section. ####

@SET_MAKE@
CC = @CC@

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@

DEFS = @DEFS@
LIBS = @LIBS@
WRAPLIBS = @WRAPLIBS@
VERSION = @PACKAGE_VERSION@.@PACKAGE_RELEASE@

prefix = @prefix@
exec_prefix = @exec_prefix@
datarootdir = @datarootdir@
srcdir = @srcdir@
docdir = @datadir@/doc/argus-5.0


#### End of system configuration section. ####

SHELL = /bin/sh

DIRS = ./common ./argus ./events
INSTDIRS = ./argus ./events

DISTFILES = AUTHORS INSTALL MANIFEST CREDITS README VERSION Makefile.in \
	bin common argus events lib man support doc include pkg debian \
	aclocal.m4 acsite.m4 config configure configure.ac lib/argus.spec \
	.threads

.c.o:
	$(CC) -c $(CPPFLAGS) $(DEFS) $(CFLAGS) $<

.PHONY: install installdirs all

all: force
	@-for d in $(DIRS);\
	do \
		(cd $$d; echo "### Making in" `pwd`;\
			$(MAKE) $(MFLAGS) ;\
			echo "### Done with" `pwd`);\
	done

install:  force
	$(MAKE) $(MFLAGS) installdirs
	[ -d $(DESTDIR)@prefix@ ] || \
		(mkdir -p $(DESTDIR)@prefix@; chmod 755 $(DESTDIR)@prefix@)
	[ -d $(DESTDIR)@sbindir@ ] || \
		(mkdir -p $(DESTDIR)@sbindir@; chmod 755 $(DESTDIR)@sbindir@)
	[ -d $(DESTDIR)@bindir@ ] || \
		(mkdir -p $(DESTDIR)@bindir@; chmod 755 $(DESTDIR)@bindir@)
	[ -d $(DESTDIR)$(exec_prefix)/argus ] || \
		(mkdir -p $(DESTDIR)$(exec_prefix)/argus; chmod 755 $(DESTDIR)$(exec_prefix)/argus)
	[ -d $(DESTDIR)$(exec_prefix)/argus/archive ] || \
		(mkdir -p $(DESTDIR)$(exec_prefix)/argus/archive; chmod 755 $(DESTDIR)$(exec_prefix)/argus/archive)

	@-for d in $(DIRS); \
	do \
		(cd $$d; echo "### Make install in" `pwd`;    \
			$(MAKE) $(MFLAGS) install;    \
			echo "### Done with" `pwd`);            \
	done

	$(INSTALL) -m 0755 $(srcdir)/bin/argusbug $(DESTDIR)@bindir@/argusbug

	[ -d $(DESTDIR)@mandir@ ] || \
		(mkdir -p $(DESTDIR)@mandir@; chmod 755 $(DESTDIR)@mandir@)
	[ -d $(DESTDIR)@mandir@/man5 ] || \
		(mkdir -p $(DESTDIR)@mandir@/man5; chmod 755 $(DESTDIR)@mandir@/man5)
	[ -d $(DESTDIR)@mandir@/man8 ] || \
		(mkdir -p $(DESTDIR)@mandir@/man8; chmod 755 $(DESTDIR)@mandir@/man8)
	$(INSTALL) -m 0644 $(srcdir)/man/man5/argus.conf.5 $(DESTDIR)@mandir@/man5/argus.conf.5
	$(INSTALL) -m 0644 $(srcdir)/man/man8/argus.8 $(DESTDIR)@mandir@/man8/argus.8

install-doc:  force
	$(MAKE) installdirs
	[ -d $(DESTDIR)@prefix@ ] || \
		(mkdir -p $(DESTDIR)@prefix@; chmod 755 $(DESTDIR)@prefix@)
	[ -d $(DESTDIR)$(docdir) ] || \
		(mkdir -p $(DESTDIR)$(docdir); chmod 755 $(DESTDIR)$(docdir))
	$(INSTALL) -m 0644 $(srcdir)/README $(DESTDIR)$(docdir)

uninstall:
	rm -f $(DESTDIR)@mandir@/man5/argus.5
	rm -f $(DESTDIR)@mandir@/man5/argus.conf.5
	rm -f $(DESTDIR)@mandir@/man8/argus.8
	rm -rf $(DESTDIR)$(docdir)
	@for i in  $(INSTDIRS) ; do \
		if [ -d $$i ] ; then \
		cd $$i; \
		$(MAKE) $(MFLAGS) uninstall; \
		cd ..; \
		fi; \
	done
	rm -f $(DESTDIR)@bindir@/argusbug

installdirs:
	${srcdir}/config/mkinstalldirs $(DESTDIR)$(bindir) $(DESTDIR)$(mandir)\
		$(DESTDIR)$(docdir) $(DESTDIR)$(exec_prefix)/argus/archive

Makefile: Makefile.in config.status
	$(SHELL) config.status

config.status: configure
	$(srcdir)/configure --no-create

TAGS: $(SRCS)
	etags $(SRCS)

.PHONY: clean mostlyclean distclean realclean dist

clean: force
	@-for d in $(DIRS); \
	do \
		(cd $$d; echo "### Make clean in" `pwd`; \
			$(MAKE) $(MFLAGS) clean; \
			echo "### Done with" `pwd`); \
	done

mostlyclean: clean

distclean: force
	@-for d in $(DIRS); \
	do \
		(cd $$d; echo "### Make distclean in" `pwd`; \
			$(MAKE) $(MFLAGS) distclean; \
			echo "### Done with" `pwd`); \
	done
	rm -rf log
	rm -f config.*
	rm -rf autom4te.cache
	rm -f TAGS
	rm -f lib/*.a
	rm -f bin/*.exe
	rm -f include/argus_config.h
	rm -f include/*~

clobber realclean: distclean
	rm -f ./Makefile
	rm -f ./*~

dist: distclean
	echo argus-`cat VERSION` > .fname
	rm -rf `cat .fname`
	mkdir `cat .fname`
	tar cf - $(DISTFILES) | (cd `cat .fname`; tar xpf -)
	ls -lR `cat .fname` | fgrep CVS: | sed 's/:$///' > exfile
	env COPYFILE_DISABLE=1 tar -X exfile -chzf `cat .fname`.tar.gz `cat .fname`
	rm -rf `cat .fname` .fname exfile

force:  /tmp
depend: force
	@for i in $(DIRS) ; do \
		if [ -d $$i ] ; then \
		cd $$i; \
		$(MAKE) $(MFLAGS) depend || exit 1; \
		cd ..; \
		fi; \
	done

# Prevent GNU make v3 from overflowing arg limit on SysV.
.NOEXPORT:
